!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.pagemap=e():t.pagemap=e()}(this,function(){return function(o){function n(t){if(r[t])return r[t].exports;var e=r[t]={exports:{},id:t,loaded:!1};return o[t].call(e.exports,e,e.exports,n),e.loaded=!0,e.exports}var r={};return n.m=o,n.c=r,n.p="",n(0)}([function(o,t,r){(function(t){"use strict";var m=r(1),b=t.window,T=b.document,E=T.querySelector("body"),e=function(t){return"rgba(0,0,0,"+t/100+")"},O={viewport:null,styles:{"header,footer,section,article":e(8),"h1,a":e(10),"h2,h3,h4":e(8)},back:e(2),view:e(5),drag:e(10),interval:null},n=function(e,o,t,n){return t.split(/\s+/).forEach(function(t){return e[o](t,n)})},W=function(t,e,o){return n(t,"addEventListener",e,o)},j=function(t,e,o){return n(t,"removeEventListener",e,o)};o.exports=function(r,t){var o,n,i=Object.assign({},O,t),c=r.getContext("2d"),u=(o=r.clientWidth,n=r.clientHeight,function(t,e){return Math.min(o/t,n/e)}),l=i.viewport,f=!1,s=void 0,a=void 0,p=void 0,h=void 0,d=void 0,v=function(t,e){e&&(c.beginPath(),c.rect(t.x,t.y,t.w,t.h),c.fillStyle=e,c.fill())},y=function(n){Object.keys(n).forEach(function(t){var e,o=n[t];(e=t,Array.from((l||T).querySelectorAll(e))).forEach(function(t){v(m.ofElement(t).relativeTo(s),o)})})},g=function(){var t,e;s=l?m.ofContent(l):m.ofDocument(),a=l?m.ofViewport(l):m.ofWindow(),p=u(s.w,s.h),t=s.w*p,e=s.h*p,r.width=t,r.height=e,r.style.width=t+"px",r.style.height=e+"px",c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,r.width,r.height),c.scale(p,p),v(s.relativeTo(s),i.back),y(i.styles),v(a.relativeTo(s),f?i.drag:i.view)},w=function(t){t.preventDefault();var e=m.ofViewport(r),o=(t.pageX-e.x)/p-a.w*h,n=(t.pageY-e.y)/p-a.h*d;l?(l.scrollLeft=o,l.scrollTop=n):b.scrollTo(o,n),g()},x=function t(e){f=!1,r.style.cursor="pointer",E.style.cursor="auto",j(b,"mousemove",w),j(b,"mouseup",t),w(e)},e=function(t){f=!0;var e=m.ofViewport(r),o=a.relativeTo(s);h=((t.pageX-e.x)/p-o.x)/o.w,d=((t.pageY-e.y)/p-o.y)/o.h,(h<0||1<h||d<0||1<d)&&(d=h=.5),r.style.cursor="crosshair",E.style.cursor="crosshair",W(b,"mousemove",w),W(b,"mouseup",x),w(t)};return r.style.cursor="pointer",W(r,"mousedown",e),W(l||b,"load resize scroll",g),0<i.interval&&setInterval(function(){return g()},i.interval),g(),{redraw:g}}}).call(t,function(){return this}())},function(n,t){(function(t){"use strict";var o=t.window,e=o.document.documentElement,r=n.exports=function(t,e,o,n){return Object.assign(Object.create(r.prototype),{x:t,y:e,w:o,h:n})};r.prototype={constructor:r,relativeTo:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};return r(this.x-t.x,this.y-t.y,this.w,this.h)}},r.ofDocument=function(){return r(0,0,e.scrollWidth,e.scrollHeight)},r.ofWindow=function(){return r(o.pageXOffset,o.pageYOffset,e.clientWidth,e.clientHeight)};var i=function(t){var e=t.getBoundingClientRect();return{x:e.left+o.pageXOffset,y:e.top+o.pageYOffset}};r.ofElement=function(t){var e=i(t),o=e.x,n=e.y;return r(o,n,t.offsetWidth,t.offsetHeight)},r.ofViewport=function(t){var e=i(t),o=e.x,n=e.y;return r(o+t.clientLeft,n+t.clientTop,t.clientWidth,t.clientHeight)},r.ofContent=function(t){var e=i(t),o=e.x,n=e.y;return r(o+t.clientLeft-t.scrollLeft,n+t.clientTop-t.scrollTop,t.scrollWidth,t.scrollHeight)}}).call(t,function(){return this}())}])});